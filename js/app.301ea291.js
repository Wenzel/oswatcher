(function(e){function t(t){for(var a,n,o=t[0],c=t[1],l=t[2],d=0,_=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&_.push(r[n][0]),r[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(_.length)_.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,o=1;o<s.length;o++){var c=s[o];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=n(n.s=s[0]))}return e}var a={},r={app:0},i=[];function n(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=a,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/oswatcher/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("cd49")},"034f":function(e,t,s){"use strict";var a=s("85ec"),r=s.n(a);r.a},"05ce":function(e,t,s){"use strict";var a=s("47ee"),r=s.n(a);r.a},"2da7":function(e,t,s){},"3aa3":function(e,t,s){},"3d6b":function(e,t,s){},"47ee":function(e,t,s){},"4cbb":function(e,t,s){"use strict";var a=s("3aa3"),r=s.n(a);r.a},"611e":function(e,t,s){},"7efc":function(e,t,s){"use strict";var a=s("611e"),r=s.n(a);r.a},"85ec":function(e,t,s){},a1d2:function(e,t,s){"use strict";var a=s("2da7"),r=s.n(a);r.a},c02e:function(e,t,s){"use strict";var a=s("dd55"),r=s.n(a);r.a},cd49:function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("Navbar"),s("div",{staticClass:"container-fluid"},[s("router-view")],1)],1)},i=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-navbar",{attrs:{type:"dark"}},[a("b-navbar-brand",{attrs:{href:"#"}},[a("img",{attrs:{src:s("cf05"),alt:"logo"}})]),a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/","active-class":"active"}},[e._v(" Home ")])],1)],1)},o=[],c=(s("a1d2"),s("2877")),l={},u=Object(c["a"])(l,n,o,!1,null,"245d5ed4",null),d=u.exports,_={components:{Navbar:d}},b=_,f=(s("034f"),s("fb26"),Object(c["a"])(b,r,i,!1,null,"a9b9b3de",null)),p=f.exports,h=s("8c4f"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",{attrs:{id:"title"}},[e._v(" Operating Systems ")]),s("b-list-group",e._l(e.os_items,(function(t){return s("b-list-group-item",{key:t["id"],attrs:{to:{name:"OSView",params:{id:t["id"]}}}},[e._v(" "+e._s(t["name"])+" ")])})),1)],1)},g=[],m=s("bc3a"),y=s.n(m),k=s("d70b"),O=s.n(k),x={name:"Home",data(){return{os_items:[]}},methods:{get_message(){const e=`${O.a.API_LOCATION}/os`;y.a.get(e).then(e=>{this.os_items=e.data.os}).catch(e=>{console.error(e)})}},created(){this.get_message()}},w=x,j=(s("05ce"),Object(c["a"])(w,v,g,!1,null,"37732c80",null)),P=j.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[null!=e.os_item?[s("h2",{attrs:{id:"title"}},[e._v(" "+e._s(e.os_item.name)+" ")]),s("b-card",{attrs:{"no-body":""}},[s("b-tabs",{attrs:{card:""}},[s("b-tab",{attrs:{title:"Filesystem",active:""}},[s("Filesystem",{attrs:{os:e.os_item}})],1),"Windows"==e.os_item.type?[s("b-tab",{attrs:{title:"Syscalls"}},[s("SyscallTable",{attrs:{os:e.os_item}})],1)]:e._e(),s("b-tab",{attrs:{title:"Security"}},[s("Security",{attrs:{os:e.os_item}})],1)],2)],1)]:e._e()],2)},$=[],N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",[e._v("Filesystem")]),s("b-overlay",{attrs:{show:e.is_loading}},[s("b-breadcrumb",e._l(e.fs_path_items,(function(t,a){return s("b-breadcrumb-item",{key:t.id,attrs:{active:t.active,disabled:t.disabled},on:{click:function(t){return e.on_breadcrumb_clicked(t,a)}}},[e._v(" "+e._s(t.part)+" ")])})),1),s("div",{attrs:{id:"filesystem"}},[s("b-list-group",[e._l(e.fs_folder_entries,(function(t){return s("b-list-group-item",{key:t.id,attrs:{action:!0},on:{click:e.on_item_clicked}},[s("b-icon",{attrs:{icon:"folder-fill"}}),e._v(" "+e._s(t.name)+" ")],1)})),e._l(e.fs_file_entries,(function(t){return s("b-list-group-item",{key:t.id},[s("b-icon",{attrs:{icon:"file-earmark"}}),e._v(" "+e._s(t.name)+" ")],1)}))],2)],1)],1)],1)},C=[];const I=s("df7c");var A={name:"Filesystem",props:{os:{required:!0,type:Object}},data(){return{is_loading:!0,fs_path:"/",fs_path_items:this.build_fs_parts("/"),fs_folder_entries:[],fs_file_entries:[]}},methods:{list_fs_at(e){const t=`${O.a.API_LOCATION}/os/${this.os.id}/filesystem${e}`;y.a.get(t).then(e=>{this.fs_folder_entries=e.data.fs_entries.filter(e=>this.inode_is_dir(e.inode_type)).sort((function(e,t){return e.name>t.name})),this.fs_file_entries=e.data.fs_entries.filter(e=>!this.inode_is_dir(e.inode_type)).sort((function(e,t){return e.name>t.name})),this.fs_path_items=this.build_fs_parts(this.fs_path)}).catch(e=>{console.error(e)})},inode_is_dir(e){return 16384==e},build_fs_parts(e){var t=[],s=e.split("/");0==s[1].length&&s.pop();for(var a=0;a<s.length;a++){var r={part:s[a],active:!1,disabled:!1};t.push(r)}return t[0]["part"]="Root",t[t.length-1]["active"]=!0,t[t.length-1]["disabled"]=!0,t},on_item_clicked(e){this.fs_path=I.join(this.fs_path,e.target.textContent.trim()),this.list_fs_at(this.fs_path)},on_breadcrumb_clicked(e,t){var s=this.fs_path_items.map(e=>e.part),a=s.slice(1,t+1),r=`/${a.join("/")}`;this.fs_path=r,this.list_fs_at(this.fs_path)}},created(){y.a.interceptors.request.use(e=>(this.is_loading=!0,e),e=>(this.is_loading=!1,Promise.reject(e))),y.a.interceptors.response.use(e=>(this.is_loading=!1,e),e=>(this.is_loading=!1,Promise.reject(e))),this.list_fs_at(this.fs_path)}},T=A,L=(s("4cbb"),Object(c["a"])(T,N,C,!1,null,"f4f83424",null)),E=L.exports,q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",[e._v("Syscall Table")]),s("div",{staticClass:"overflow-auto"},[s("b-pagination",{attrs:{"total-rows":e.rows,"per-page":e.per_page,"aria-controls":"syscall_table"},model:{value:e.current_page,callback:function(t){e.current_page=t},expression:"current_page"}}),s("b-table",{attrs:{id:"syscall_table",striped:"",hover:"",bordered:"",items:e.items,fields:e.fields,"per-page":e.per_page,"current-page":e.current_page,busy:e.is_loading,"sort-by":"index"},scopedSlots:e._u([{key:"table-busy",fn:function(){return[s("div",{staticClass:"text-center text-info my-2"},[s("b-spinner",{staticClass:"align-middle"}),s("strong",[e._v("Loading...")])],1)]},proxy:!0}])})],1)])},F=[],Y={name:"SyscallTable",props:{os:{required:!0,type:Object}},data(){return{is_loading:!0,fields:[{key:"index",sortable:!0},{key:"address"},{key:"name",sortable:!0}],items:[],per_page:20,current_page:1}},computed:{rows(){return this.items.length}},methods:{list_syscalls(){const e=`${O.a.API_LOCATION}/os/${this.os.id}/syscall`;y.a.get(e).then(e=>{this.items=e.data.syscall_entries}).catch(e=>{console.error(e)})}},created(){y.a.interceptors.request.use(e=>(this.is_loading=!0,e),e=>(this.is_loading=!1,Promise.reject(e))),y.a.interceptors.response.use(e=>(this.is_loading=!1,e),e=>(this.is_loading=!1,Promise.reject(e))),this.list_syscalls()}},M=Y,H=Object(c["a"])(M,q,F,!1,null,"07381af0",null),R=H.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",["Linux"==e.os.type?[s("h2",[e._v(" Setuid Binaries "),s("b-badge",{attrs:{variant:"secondary"}},[e._v(e._s(e.setuid_count))])],1),s("b-overlay",{staticClass:"mb-5",attrs:{show:e.is_loading}},[s("b-list-group",e._l(e.setuid_list,(function(t){return s("b-list-group-item",{key:t.path,staticClass:"text-monospace"},[e._v(" "+e._s(t.path)+" ")])})),1)],1),s("h2",[e._v(" Checksec Binaries "),s("b-badge",{attrs:{variant:"secondary"}},[e._v(e._s(e.checksec_count))])],1),s("b-pagination",{attrs:{"total-rows":e.checksec_count,"per-page":e.checksec_per_page,"aria-controls":"checksec_table"},model:{value:e.checksec_current_page,callback:function(t){e.checksec_current_page=t},expression:"checksec_current_page"}}),s("b-table",{attrs:{id:"checksec_table",striped:"",hover:"",bordered:"","head-variant":"dark",items:e.checksec_items_list,fields:e.checksec_fields,"per-page":e.checksec_per_page,"current-page":e.checksec_current_page,busy:e.is_loading,"sort-by":"path"},scopedSlots:e._u([{key:"cell(relro)",fn:function(t){return["full"==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" Full ")]):"no"==t.value?s("b-badge",{attrs:{variant:"danger"}},[e._v(" No ")]):s("b-badge",{attrs:{variant:"warning"}},[e._v(" Partial ")])]}},{key:"cell(canary)",fn:function(t){return[1==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" Yes ")]):s("b-badge",{attrs:{variant:"danger"}},[e._v(" No ")])]}},{key:"cell(nx)",fn:function(t){return[1==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" Yes ")]):s("b-badge",{attrs:{variant:"danger"}},[e._v(" No ")])]}},{key:"cell(pie)",fn:function(t){return["yes"==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" Yes ")]):"no"==t.value?s("b-badge",{attrs:{variant:"danger"}},[e._v(" No ")]):s("b-badge",{attrs:{variant:"warning"}},[e._v(" "+e._s(t.value)+" ")])]}},{key:"cell(rpath)",fn:function(t){return[0==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" No ")]):s("b-badge",{attrs:{variant:"danger"}},[e._v(" "+e._s(t.value)+" ")])]}},{key:"cell(runpath)",fn:function(t){return[1==t.value?s("b-badge",{attrs:{variant:"danger"}},[e._v(" Yes ")]):s("b-badge",{attrs:{variant:"success"}},[e._v(" No ")])]}},{key:"cell(symbols)",fn:function(t){return[1==t.value?s("b-badge",{attrs:{variant:"danger"}},[e._v(" Yes ")]):s("b-badge",{attrs:{variant:"success"}},[e._v(" No ")])]}},{key:"cell(fortify_source)",fn:function(t){return[1==t.value?s("b-badge",{attrs:{variant:"success"}},[e._v(" Yes ")]):s("b-badge",{attrs:{variant:"danger"}},[e._v(" No ")])]}},{key:"cell(fortify_score)",fn:function(t){return[t.item.fortify_source&&0==t.item.fortifyable?s("b-badge",{attrs:{variant:"success"}},[e._v(" 100% ")]):t.item.fortify_source||0!=t.item.fortifyable?s("b-badge",{attrs:{variant:"warning"}},[e._v(" "+e._s(Math.round(100*t.item.fortified/t.item.fortifyable))+"% ")]):s("b-badge",{attrs:{variant:"danger"}},[e._v(" 0% ")])]}}],null,!1,3356178671)})]:e._e()],2)},B=[],J={name:"Security",props:{os:{required:!0,type:Object}},data(){return{is_loading:!0,setuid_list:[],checksec_items_list:[],checksec_fields:[{key:"path",sortable:!0,tdClass:"text-monospace"},{key:"name",sortable:!0,tdClass:"text-monospace"},{key:"relro",label:"Relocation Read-Only",sortable:!0},{key:"canary",sortable:!0},{key:"nx",label:"Non-Executable",sortable:!0},{key:"pie",label:"Position-Independant Executable",sortable:!0},{key:"rpath",sortable:!0},{key:"runpath",sortable:!0},{key:"symbols",sortable:!0},{key:"fortify_source",sortable:!0},{key:"fortify_score",sortable:!0}],checksec_per_page:10,checksec_current_page:1}},methods:{list_setuid(){const e=`${O.a.API_LOCATION}/os/${this.os.id}/filesystem/search`,t={setuid:!0};y.a.post(e,t).then(e=>{this.setuid_list=e.data.result}).catch(e=>{console.error(e)})},list_checksec(){const e=`${O.a.API_LOCATION}/os/${this.os.id}/filesystem/search`,t={checksec:!0};y.a.post(e,t).then(e=>{this.checksec_items_list=e.data.result}).catch(e=>{console.error(e)})}},computed:{setuid_count(){return this.setuid_list.length},checksec_count(){return this.checksec_items_list.length}},created(){y.a.interceptors.request.use(e=>(this.is_loading=!0,e),e=>(this.is_loading=!1,Promise.reject(e))),y.a.interceptors.response.use(e=>(this.is_loading=!1,e),e=>(this.is_loading=!1,Promise.reject(e))),"Linux"==this.os.type&&(this.list_setuid(),this.list_checksec())}},W=J,z=(s("7efc"),Object(c["a"])(W,V,B,!1,null,"508b5415",null)),D=z.exports,G={name:"OSView",components:{Filesystem:E,SyscallTable:R,Security:D},props:{id:{required:!0,type:String}},data(){return{os_item:null}},created(){const e=`${O.a.API_LOCATION}/os/${this.id}`;y.a.get(e).then(e=>{this.os_item=e.data.os}).catch(e=>{console.error(e)})}},K=G,Q=(s("c02e"),Object(c["a"])(K,S,$,!1,null,"e3edb100",null)),U=Q.exports;a["default"].use(h["a"]);var X=[{path:"/",name:"Home",component:P},{path:"/os_view/:id",name:"OSView",component:U,props:!0}],Z=new h["a"]({mode:"history",base:"/oswatcher/",routes:X}),ee=Z,te=s("5f5b"),se=s("b1e0");s("f9e3"),s("2dd8");a["default"].use(te["a"]),a["default"].use(se["a"]),a["default"].config.productionTip=!1,new a["default"]({router:ee,render:function(e){return e(p)}}).$mount("#app")},cf05:function(e,t,s){e.exports=s.p+"img/logo.be443169.png"},d70b:function(e,t,s){"use strict";e.exports={API_LOCATION:"http://34.65.83.178:5000"}},dd55:function(e,t,s){},fb26:function(e,t,s){"use strict";var a=s("3d6b"),r=s.n(a);r.a}});
//# sourceMappingURL=app.301ea291.js.map